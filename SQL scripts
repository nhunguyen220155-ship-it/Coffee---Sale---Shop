SQL SCRIPT FOR COFFEE SHOP SALE
Data cleaning
UPDATE [Coffee Shop Sales]
SET transaction_date = CONVERT(date, transaction_date, 105);

ALTER TABLE [Coffee Shop Sales]
ALTER COLUMN transaction_date DATE;

UPDATE [Coffee Shop Sales]
SET transaction_time = CONVERT(time, transaction_time);

ALTER TABLE [Coffee Shop Sales]
ALTER COLUMN transaction_time TIME;
TOTAL SALES
SELECT 
    ROUND(SUM(unit_price * transaction_qty), 0) AS Total_Sales
FROM [Coffee Shop Sales]
WHERE transaction_date >= '2023-05-01'
  AND transaction_date <  '2023-06-01';

TOTAL SALES KPI - MOM DIFFERENCE AND MOM GROWTH
WITH monthly_sales AS (
    SELECT
        YEAR(transaction_date) AS year,
        MONTH(transaction_date) AS month,
        SUM(unit_price * transaction_qty) AS total_sales
    FROM [Coffee Shop Sales]
    WHERE transaction_date >= '2023-04-01'
      AND transaction_date < '2023-06-01'
    GROUP BY YEAR(transaction_date), MONTH(transaction_date)
)
SELECT
    year,
    month,
    ROUND(total_sales, 0) AS total_sales,
    ROUND(
        (total_sales - LAG(total_sales) OVER (PARTITION BY year ORDER BY month))
        / LAG(total_sales) OVER (PARTITION BY year ORDER BY month) * 100,
        2
    ) AS mom_growth_pct
FROM monthly_sales
ORDER BY month;

TOTAL ORDERS by MONTHS
SELECT 
    YEAR(transaction_date) AS year,
    MONTH(transaction_date) AS month,
    COUNT(*) AS total_orders
FROM [Coffee Shop Sales]
GROUP BY YEAR(transaction_date), MONTH(transaction_date)
ORDER BY year, month;




CALENDAR TABLE – DAILY SALES, QUANTITY and TOTAL ORDERS
SELECT
    transaction_date,
    ROUND(SUM(unit_price * transaction_qty), 0) AS total_sales,
    SUM(transaction_qty) AS total_quantity_sold,
    COUNT(*) AS total_orders
FROM [Coffee Shop Sales]
WHERE transaction_date = '2023-05-18'
GROUP BY transaction_date;

SALE TREND PERIOD
SELECT
    YEAR(transaction_date) AS year,
    MONTH(transaction_date) AS month,
    ROUND(SUM(unit_price * transaction_qty), 0) AS monthly_sales
FROM [Coffee Shop Sales]
GROUP BY YEAR(transaction_date), MONTH(transaction_date)
ORDER BY year, month;
WITH monthly_sales AS (
—

    SELECT
        YEAR(transaction_date) AS year,
        MONTH(transaction_date) AS month,
        SUM(unit_price * transaction_qty) AS total_sales
    FROM [Coffee Shop Sales]
    GROUP BY YEAR(transaction_date), MONTH(transaction_date)
)
SELECT
    year,
    month,
    ROUND(total_sales, 0) AS total_sales,
    ROUND(
        (total_sales - LAG(total_sales) OVER (PARTITION BY year ORDER BY month))
        * 100.0
        / NULLIF(LAG(total_sales) OVER (PARTITION BY year ORDER BY month), 0),
        2
    ) AS mom_growth_pct
FROM monthly_sales
ORDER BY year, month;

